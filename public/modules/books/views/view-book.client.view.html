<!--
    Copyright (c) 2015 Brady St. John
    This program is released under The MIT License (MIT).
    Please see the file COPYING in this distribution for
    license terms.
-->
<style>
    .st-sort-default:before {content: '\25B1'}
    .st-sort-ascent:before {content: '\25B2'}
    .st-sort-descent:before {content: '\25BC'}
</style>
<section data-ng-controller="BooksController" data-ng-init="findOne()">
    <div class="page-header">
        <div>
            <h1 data-ng-bind="book.title | properCase"></h1>
            <h4 data-ng-bind="book.author | properCase"></h4>
            <p data-ng-bind="book.releaseDate | date:'MM/dd/yyyy'"></p>
            <div style="word-wrap:break-word; margin-bottom: 25px">
                <div ng-show="!showFullDesc">
                    <span style="" ng-bind="currentDesc | limitTo : maxDisplayDescLength" data-ng-init="updateDesc()"></span>
                    <span ng-show="currentDesc.length > maxDisplayDescLength">[...]</span>
                    <div ng-show="currentDesc.length > maxDisplayDescLength">
                        <a class="pull-right" ng-click="toggleFullDesc()">
                            <i class="glyphicon glyphicon-chevron-right"></i><strong>More</strong>
                        </a>
                    </div>
                </div>
                <div ng-show="showFullDesc">
                    <p ng-bind="currentDesc" data-ng-init="updateDesc()"></p>
                    <a class="pull-right" ng-click="toggleFullDesc()">
                        <i class="glyphicon glyphicon-chevron-left"></i><strong>Less</strong>
                    </a>
                </div>
            </div>

            <div class="">
                <a class="btn btn-primary" href="/#!/books/{{book._id}}/edit">
                    <i class="glyphicon glyphicon-edit"></i>
                </a>
                <a class="btn btn-primary" data-ng-click="remove();">
                    <i class="glyphicon glyphicon-trash"></i>
                </a>
            </div>
        </div>
    </div>
    
    <!-- <section data-ng-controller="CharactersController">
        <button type="button" class="btn btn-primary glyphicon glyphicon-plus" ng-click="toggleModal()">
            New
        </button>

        <modal title="Create Character" visible="showModal">
        </modal>
    </section> -->

    <div>
        <h2 class="pull-left">
            Characters
        </h2>
        <div class="pull-right">
            <div style="bottom: 15px;position: relative;top: 15px">
                <a data-ng-href="#!/characters/create" class="btn btn-info">
                    <span class="glyphicon glyphicon-plus"></span> New Character
                </a>
            </div>
        </div>
    </div>
    <div data-ng-init="initTable()">
        <!--<table st-table="characterCollection" st-safe-src="bookCharacters" class="table table-striped">-->
        <table st-table="bookCharacters" st-safe-src="displayedCharacters" class="table table-striped">
            <thead>
            <tr>
                <th colspan="5"><input st-search="" class="form-control" placeholder="Search.." type="search"/></th>
            </tr>
            <tr>
                <th st-sort="introChapter" st-sort-default="true">Chapter</th>
                <th st-sort="firstName">First</th>
                <!-- <th st-sort="middleName">Middle Name</th> -->
                <th st-sort="lastName">Last</th>
                <th st-sort="description">Description</th>
            </tr>
            </thead>
            <tbody>
            <tr ng-repeat="character in bookCharacters">
                <td>{{character.introChapter}}</td>
                <td>{{character.firstName | properCase}}</td>
                <!-- <td>{{character.middleName | properCase}}</td> -->
                <td>{{character.lastName | properCase}}</td>
                <td>
                    <span>{{character.description | limitTo : descLimit}}</span><span class="" ng-show="character.description.length > descLimit">...</span>
                </td>                <td>
                    <a class="btn" href="/#!/characters/{{character._id}}">
                        <i class="glyphicon glyphicon-eye-open"></i>
                    </a>
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</section>
